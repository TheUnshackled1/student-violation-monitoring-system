{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reports - OSA Staff</title>
  <link rel="stylesheet" href="{% static 'violations/css/style.css' %}" />
  <link rel="stylesheet" href="{% static 'violations/css/main.css' %}" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
</head>
<body class="role-staff">
  <!-- Official Top Navigation -->
  <header class="official-top-nav">
    <div class="nav-container">
      <div class="nav-brand">
        <div class="brand-logo">
          <img src="{% static 'violations/images/chmsu_logo.png' %}" alt="CHMSU" />
        </div>
        <div class="brand-text">
          <span class="brand-university">CHMSU</span>
          <span class="brand-title">OSA Staff Portal</span>
        </div>
      </div>

      <div class="nav-center">
        <span class="nav-department">Office of Student Affairs</span>
        <span class="nav-system">Violation Reports & Analytics</span>
      </div>

      <div class="nav-actions">
        <div class="export-dropdown no-print">
          <button class="nav-icon-btn" onclick="toggleExportMenu()" title="Export Report">
            <i class="fas fa-download"></i>
          </button>
          <div class="export-menu" id="exportMenu">
            <a href="{% url 'violations:staff_export_report' %}?start_date={{ start_date }}&end_date={{ end_date }}" class="export-option">
              <i class="fas fa-file-csv"></i> Export CSV
            </a>
            <button onclick="window.print()" class="export-option">
              <i class="fas fa-file-pdf"></i> Print/PDF
            </button>
          </div>
        </div>
        <button class="nav-icon-btn no-print" onclick="openSendModal()" title="Send to Coordinator">
          <i class="fas fa-paper-plane"></i>
        </button>
        <button class="nav-icon-btn" onclick="window.print()" title="Print Report">
          <i class="fas fa-print"></i>
        </button>
        <a href="javascript:history.back()" class="nav-icon-btn" title="Go Back">
          <i class="fas fa-arrow-left"></i> Back
        </a>
      </div>
    </div>
  </header>

  <div class="background-overlay"></div>
  <div class="background-image"></div>

  <main class="container" style="position:relative; z-index:3; margin-top: calc(var(--header-height) + 24px);">
    
    <!-- Official Statistics Section -->
    <section class="official-stats-section">
      <div class="stats-header">
        <div class="stats-header-logo">
          <img src="{% static 'violations/images/chmsu_logo.png' %}" alt="CHMSU Logo">
        </div>
        <div class="stats-header-text">
          <p class="stats-republic">Republic of the Philippines</p>
          <h1 class="stats-university">CARLOS HILADO MEMORIAL STATE UNIVERSITY</h1>
          <p class="stats-address">Talisay City, Negros Occidental</p>
          <p class="stats-office">Office of Student Affairs</p>
        </div>
        <div class="stats-header-logo">
          <img src="{% static 'violations/images/chmsu_logo.png' %}" alt="CHMSU Logo">
        </div>
      </div>

      <div class="stats-title-bar">
        <h2 class="stats-title"><i class="fas fa-chart-bar"></i> VIOLATION REPORTS SUMMARY</h2>
        <p class="stats-subtitle">
          {% if start_date and end_date %}
            Report Period: {{ start_date|date:"M d, Y" }} - {{ end_date|date:"M d, Y" }}
          {% else %}
            As of {% now "F d, Y" %}
          {% endif %}
        </p>
      </div>

      <!-- Date Filter -->
      <div class="report-filter-bar no-print">
        <form method="get" class="filter-form">
          <div class="filter-group">
            <label><i class="fas fa-calendar-alt"></i> From:</label>
            <input type="date" name="start_date" value="{{ start_date|date:'Y-m-d' }}" class="filter-date">
          </div>
          <div class="filter-group">
            <label><i class="fas fa-calendar-alt"></i> To:</label>
            <input type="date" name="end_date" value="{{ end_date|date:'Y-m-d' }}" class="filter-date">
          </div>
          <button type="submit" class="filter-btn"><i class="fas fa-filter"></i> Generate Report</button>
          <a href="{% url 'violations:staff_reports' %}" class="filter-btn-clear"><i class="fas fa-redo"></i> Reset</a>
        </form>
      </div>

      <!-- Main Stats Grid -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon stat-icon-total">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <div class="stat-content">
            <span class="stat-label">Total Violations</span>
            <span class="stat-value">{{ total_violations }}</span>
            <span class="stat-desc">All recorded cases</span>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon stat-icon-pending">
            <i class="fas fa-clock"></i>
          </div>
          <div class="stat-content">
            <span class="stat-label">Pending</span>
            <span class="stat-value">{{ pending_count }}</span>
            <span class="stat-desc">Awaiting resolution</span>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon stat-icon-progress">
            <i class="fas fa-spinner"></i>
          </div>
          <div class="stat-content">
            <span class="stat-label">In Progress</span>
            <span class="stat-value">{{ in_progress_count }}</span>
            <span class="stat-desc">Being processed</span>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon stat-icon-resolved">
            <i class="fas fa-check-circle"></i>
          </div>
          <div class="stat-content">
            <span class="stat-label">Resolved</span>
            <span class="stat-value">{{ resolved_count }}</span>
            <span class="stat-desc">Successfully closed</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Resolution Metrics Row -->
    <section class="metrics-row" style="margin-top: 20px;">
      <div class="metric-card resolution-metric">
        <div class="metric-icon" style="background: linear-gradient(135deg, #059669 0%, #10b981 100%);">
          <i class="fas fa-chart-pie"></i>
        </div>
        <div class="metric-content">
          <span class="metric-label">Resolution Rate</span>
          <span class="metric-value">{{ resolution_rate }}%</span>
          <span class="metric-desc">of violations resolved</span>
        </div>
        <div class="metric-visual">
          <svg class="progress-ring" width="60" height="60">
            <circle class="progress-ring-bg" stroke="#e5e7eb" stroke-width="6" fill="transparent" r="24" cx="30" cy="30"/>
            <circle class="progress-ring-circle" stroke="#059669" stroke-width="6" fill="transparent" r="24" cx="30" cy="30"
              style="stroke-dasharray: {{ resolution_rate|default:0 }} 100; transform: rotate(-90deg); transform-origin: 50% 50%;"/>
          </svg>
        </div>
      </div>
      
      <div class="metric-card">
        <div class="metric-icon" style="background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);">
          <i class="fas fa-clock"></i>
        </div>
        <div class="metric-content">
          <span class="metric-label">Avg Resolution Time</span>
          <span class="metric-value">{{ avg_resolution_days }} days</span>
          <span class="metric-desc">average to resolve</span>
        </div>
      </div>
      
      <div class="metric-card">
        <div class="metric-icon" style="background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%);">
          <i class="fas fa-envelope-open-text"></i>
        </div>
        <div class="metric-content">
          <span class="metric-label">Total Apology Letters</span>
          <span class="metric-value">{{ total_apologies }}</span>
          <span class="metric-desc">letters submitted</span>
        </div>
      </div>
    </section>

    <!-- Apology Letter Statistics Section -->
    <section class="official-directory-section" style="margin-top:20px;">
      <div class="directory-title-bar">
        <h2 class="directory-title"><i class="fas fa-envelope"></i> APOLOGY LETTER STATISTICS</h2>
        <p class="directory-subtitle">Submission and approval status</p>
      </div>

      <div class="apology-stats-grid">
        <div class="apology-stat-card">
          <div class="apology-stat-icon pending">
            <i class="fas fa-hourglass-half"></i>
          </div>
          <div class="apology-stat-value">{{ apology_pending }}</div>
          <div class="apology-stat-label">Pending Review</div>
        </div>
        
        <div class="apology-stat-card">
          <div class="apology-stat-icon approved">
            <i class="fas fa-check-circle"></i>
          </div>
          <div class="apology-stat-value">{{ apology_approved }}</div>
          <div class="apology-stat-label">Staff Approved</div>
        </div>
        
        <div class="apology-stat-card">
          <div class="apology-stat-icon rejected">
            <i class="fas fa-times-circle"></i>
          </div>
          <div class="apology-stat-value">{{ apology_rejected }}</div>
          <div class="apology-stat-label">Rejected</div>
        </div>
        
        <div class="apology-stat-card">
          <div class="apology-stat-icon revision">
            <i class="fas fa-edit"></i>
          </div>
          <div class="apology-stat-value">{{ apology_revision }}</div>
          <div class="apology-stat-label">Needs Revision</div>
        </div>
        
        <div class="apology-stat-card">
          <div class="apology-stat-icon formator">
            <i class="fas fa-user-clock"></i>
          </div>
          <div class="apology-stat-value">{{ apology_formator }}</div>
          <div class="apology-stat-label">With Formator</div>
        </div>
        
        <div class="apology-stat-card">
          <div class="apology-stat-icon signed">
            <i class="fas fa-signature"></i>
          </div>
          <div class="apology-stat-value">{{ apology_signed }}</div>
          <div class="apology-stat-label">Formator Signed</div>
        </div>
      </div>
    </section>

    <!-- Severity Distribution Section -->
    <section class="official-directory-section" style="margin-top:20px;">
      <div class="directory-title-bar">
        <h2 class="directory-title"><i class="fas fa-exclamation-circle"></i> SEVERITY DISTRIBUTION</h2>
        <p class="directory-subtitle">Violations by severity level</p>
      </div>

      <div class="severity-container">
        {% for severity in severity_stats %}
        <div class="severity-item">
          <div class="severity-header">
            <span class="severity-label severity-{{ severity.severity_key }}">
              <i class="fas fa-{% if severity.severity_key == 'minor' %}info-circle{% elif severity.severity_key == 'major' %}exclamation-triangle{% else %}skull-crossbones{% endif %}"></i>
              {{ severity.severity }}
            </span>
            <span class="severity-count">{{ severity.count }} cases ({{ severity.percentage }}%)</span>
          </div>
          <div class="severity-bar">
            <div class="severity-fill" style="width: {{ severity.percentage }}%; background: {{ severity.color }};"></div>
          </div>
        </div>
        {% empty %}
        <div class="empty-breakdown">
          <i class="fas fa-chart-bar"></i>
          <p>No severity data available</p>
        </div>
        {% endfor %}
      </div>
    </section>

    <!-- Program/Department Breakdown Section -->
    <section class="official-directory-section" style="margin-top:20px;">
      <div class="directory-title-bar">
        <h2 class="directory-title"><i class="fas fa-building"></i> PROGRAM BREAKDOWN</h2>
        <p class="directory-subtitle">Violations by academic program</p>
      </div>

      <div class="program-container">
        {% for prog in program_breakdown %}
        <div class="program-item">
          <div class="program-info">
            <span class="program-name">{{ prog.program }}</span>
            <span class="program-stats">{{ prog.count }} ({{ prog.percentage }}%)</span>
          </div>
          <div class="program-bar">
            <div class="program-fill" style="width: {{ prog.percentage }}%; background: {{ prog.color }};"></div>
          </div>
        </div>
        {% empty %}
        <div class="empty-breakdown">
          <i class="fas fa-building"></i>
          <p>No program data available</p>
        </div>
        {% endfor %}
      </div>
    </section>

    <!-- Year Level Analysis Section -->
    <section class="official-directory-section" style="margin-top:20px;">
      <div class="directory-title-bar">
        <h2 class="directory-title"><i class="fas fa-graduation-cap"></i> YEAR LEVEL ANALYSIS</h2>
        <p class="directory-subtitle">Violations by student year level</p>
      </div>

      <div class="year-level-container">
        {% for yl in year_level_breakdown %}
        <div class="year-level-card">
          <div class="year-level-num">{{ yl.year_num|default:"?" }}</div>
          <div class="year-level-label">{{ yl.year }}</div>
          <div class="year-level-count">{{ yl.count }}</div>
          <div class="year-level-bar-wrap">
            <div class="year-level-bar" style="height: {{ yl.percentage }}%;"></div>
          </div>
        </div>
        {% empty %}
        <div class="empty-breakdown" style="width: 100%;">
          <i class="fas fa-graduation-cap"></i>
          <p>No year level data available</p>
        </div>
        {% endfor %}
      </div>
    </section>

    <!-- Violation Breakdown Section -->
    <section class="official-directory-section" style="margin-top:20px;">
      <div class="directory-title-bar">
        <h2 class="directory-title"><i class="fas fa-chart-pie"></i> VIOLATION TYPE BREAKDOWN</h2>
        <p class="directory-subtitle">Distribution by category</p>
      </div>

      <div class="breakdown-container">
        {% for type_data in violation_types %}
        <div class="breakdown-item">
          <div class="breakdown-bar">
            <div class="breakdown-fill" style="width: {{ type_data.percentage }}%; background: {{ type_data.color|default:'#1a472a' }};"></div>
          </div>
          <div class="breakdown-info">
            <span class="breakdown-name">{{ type_data.type }}</span>
            <span class="breakdown-count">{{ type_data.count }} cases ({{ type_data.percentage }}%)</span>
          </div>
        </div>
        {% empty %}
        <div class="empty-breakdown">
          <i class="fas fa-chart-pie"></i>
          <p>No violation data available for this period</p>
        </div>
        {% endfor %}
      </div>
    </section>

    <!-- Analytics Cards -->
    <div class="analytics-row" style="margin-top:20px;">
      <!-- Top Offenders -->
      <section class="analytics-card">
        <div class="analytics-header">
          <h3><i class="fas fa-user-times"></i> Top Offenders</h3>
        </div>
        <div class="analytics-content">
          <table class="analytics-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Student</th>
                <th>Violations</th>
              </tr>
            </thead>
            <tbody>
              {% for student in top_offenders %}
              <tr>
                <td>{{ forloop.counter }}</td>
                <td>
                  {% if student.student__student_id %}
                  <a href="{% url 'violations:staff_student_detail' student.student__student_id %}">{{ student.student__user__first_name }} {{ student.student__user__last_name }}</a>
                  <div class="student-id-sub">{{ student.student__student_id }}</div>
                  {% else %}
                  <span>Unknown Student</span>
                  {% endif %}
                </td>
                <td><span class="count-badge">{{ student.count }}</span></td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="3" class="empty-cell">No data available</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </section>

      <!-- Monthly Trend -->
      <section class="analytics-card">
        <div class="analytics-header">
          <h3><i class="fas fa-chart-line"></i> Monthly Trend</h3>
        </div>
        <div class="analytics-content">
          <div class="trend-chart">
            {% for month in monthly_trend %}
            <div class="trend-bar-container">
              <div class="trend-bar" style="height: {{ month.height }}%;">
                <span class="trend-value">{{ month.count }}</span>
              </div>
              <span class="trend-label">{{ month.month }}</span>
            </div>
            {% empty %}
            <div class="empty-trend">
              <i class="fas fa-chart-line"></i>
              <p>No trend data available</p>
            </div>
            {% endfor %}
          </div>
        </div>
      </section>
    </div>

    <!-- Recent Violations Table -->
    <section class="official-directory-section" style="margin-top:20px;">
      <div class="directory-title-bar">
        <h2 class="directory-title"><i class="fas fa-list-alt"></i> RECENT VIOLATIONS</h2>
        <p class="directory-subtitle">Latest 10 recorded cases</p>
      </div>

      <div class="directory-table-wrapper">
        <table class="directory-table">
          <thead>
            <tr>
              <th class="col-seq">#</th>
              <th class="col-name">Student</th>
              <th class="col-type">Violation Type</th>
              <th class="col-date">Date</th>
              <th class="col-status">Status</th>
              <th class="col-staff">Recorded By</th>
            </tr>
          </thead>
          <tbody>
            {% for violation in recent_violations %}
            <tr>
              <td class="col-seq">{{ forloop.counter }}</td>
              <td class="col-name">
                <a href="{% url 'violations:staff_student_detail' violation.student.student_id %}" class="student-link">
                  {{ violation.student.user.get_full_name|default:violation.student.student_id }}
                </a>
                <div class="student-id-sub">{{ violation.student.student_id }}</div>
              </td>
              <td class="col-type">
                {% if violation.violation_type %}
                  <span class="type-badge type-{{ violation.violation_type.severity|default:'minor' }}">{{ violation.violation_type.name }}</span>
                {% else %}
                  <span class="type-badge">{{ violation.type|default:"â€”" }}</span>
                {% endif %}
              </td>
              <td class="col-date">{{ violation.date_reported|date:"M d, Y" }}<br><span class="time-sub">{{ violation.date_reported|date:"g:i A" }}</span></td>
              <td class="col-status">
                {% if violation.status == 'resolved' %}
                  <span class="status-badge status-resolved"><i class="fas fa-check"></i> Resolved</span>
                {% elif violation.status == 'in_progress' %}
                  <span class="status-badge status-progress"><i class="fas fa-spinner"></i> In Progress</span>
                {% else %}
                  <span class="status-badge status-pending"><i class="fas fa-clock"></i> Pending</span>
                {% endif %}
              </td>
              <td class="col-staff">{{ violation.reported_by.get_full_name|default:'System' }}</td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="6" class="empty-state">
                <i class="fas fa-inbox"></i>
                <p>No violations recorded</p>
                <span>There are no violation records for this period</span>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- Footer -->
      <div class="directory-footer">
        <p><i class="fas fa-info-circle"></i> This report is system-generated. For official records, please contact the Office of Student Affairs.</p>
        <p class="print-only">Generated on: {% now "F d, Y - g:i A" %}</p>
      </div>
    </section>
  </main>

  <!-- Send to Coordinator Modal -->
  <div class="modal-overlay" id="sendModal">
    <div class="modal-container">
      <div class="modal-header">
        <h3><i class="fas fa-paper-plane"></i> Send Report to OSA Coordinator</h3>
        <button class="modal-close" onclick="closeSendModal()">&times;</button>
      </div>
      <form method="post" action="{% url 'violations:staff_send_report' %}">
        {% csrf_token %}
        <input type="hidden" name="start_date" value="{{ start_date }}">
        <input type="hidden" name="end_date" value="{{ end_date }}">
        <div class="modal-body">
          <div class="form-group">
            <label>Report Period:</label>
            <p class="form-static">
              {% if start_date and end_date %}
                {{ start_date }} to {{ end_date }}
              {% else %}
                All Records (As of {% now "M d, Y" %})
              {% endif %}
            </p>
          </div>
          <div class="form-group">
            <label for="message">Additional Notes (Optional):</label>
            <textarea name="message" id="message" rows="4" class="form-textarea" placeholder="Add any additional notes or highlights for the coordinator..."></textarea>
          </div>
          <div class="report-summary">
            <h4>Report Summary</h4>
            <div class="summary-grid">
              <div class="summary-item">
                <span class="summary-label">Total Violations</span>
                <span class="summary-value">{{ total_violations }}</span>
              </div>
              <div class="summary-item">
                <span class="summary-label">Pending</span>
                <span class="summary-value">{{ pending_count }}</span>
              </div>
              <div class="summary-item">
                <span class="summary-label">In Progress</span>
                <span class="summary-value">{{ in_progress_count }}</span>
              </div>
              <div class="summary-item">
                <span class="summary-label">Resolved</span>
                <span class="summary-value">{{ resolved_count }}</span>
              </div>
              <div class="summary-item">
                <span class="summary-label">Resolution Rate</span>
                <span class="summary-value">{{ resolution_rate }}%</span>
              </div>
              <div class="summary-item">
                <span class="summary-label">Apology Letters</span>
                <span class="summary-value">{{ total_apologies }}</span>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn-cancel" onclick="closeSendModal()">Cancel</button>
          <button type="submit" class="btn-send"><i class="fas fa-paper-plane"></i> Send Report</button>
        </div>
      </form>
    </div>
  </div>

  <script src="{% static 'violations/js/script.js' %}"></script>
  
  <script>
    // Export Dropdown Toggle
    function toggleExportMenu() {
      const menu = document.getElementById('exportMenu');
      menu.classList.toggle('show');
    }
    
    // Close menus when clicking outside
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.export-dropdown')) {
        const menu = document.getElementById('exportMenu');
        if (menu) menu.classList.remove('show');
      }
    });
    
    // Send to Coordinator Modal
    function openSendModal() {
      document.getElementById('sendModal').classList.add('show');
      document.body.style.overflow = 'hidden';
    }
    
    function closeSendModal() {
      document.getElementById('sendModal').classList.remove('show');
      document.body.style.overflow = '';
    }
    
    // Close modal on overlay click
    document.getElementById('sendModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeSendModal();
      }
    });
    
    // Close modal on escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeSendModal();
        const printMenu = document.getElementById('printSettingsMenu');
        if (printMenu) printMenu.classList.remove('show');
        const exportMenu = document.getElementById('exportMenu');
        if (exportMenu) exportMenu.classList.remove('show');
      }
    });
  </script>
  
  <style>
    /* Official Top Navigation Styles */
    .official-top-nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 10000;
      background: linear-gradient(135deg, #1a472a 0%, #2d5a3f 50%, #1a472a 100%);
      box-shadow: 0 2px 12px rgba(0,0,0,0.15);
      border-bottom: 3px solid #fbbf24;
    }

    .nav-container {
      max-width: 1600px;
      margin: 0 auto;
      padding: 0 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 64px;
    }

    .nav-brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .brand-logo img {
      width: 42px;
      height: 42px;
      object-fit: contain;
      border-radius: 50%;
      background: white;
      padding: 2px;
    }

    .brand-text {
      display: flex;
      flex-direction: column;
    }

    .brand-university {
      font-family: 'Times New Roman', Georgia, serif;
      font-size: 11px;
      font-weight: 700;
      color: #fbbf24;
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    .brand-title {
      font-family: 'Poppins', sans-serif;
      font-size: 14px;
      font-weight: 600;
      color: #ffffff;
      letter-spacing: 0.5px;
    }

    .nav-center {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .nav-department {
      font-family: 'Times New Roman', Georgia, serif;
      font-size: 10px;
      color: #fbbf24;
      letter-spacing: 1.5px;
      text-transform: uppercase;
    }

    .nav-system {
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      font-weight: 500;
      color: #ffffff;
    }

    .nav-actions {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .nav-icon-btn {
      padding: 8px 16px;
      border-radius: 8px;
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      color: #ffffff;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
    }

    .nav-icon-btn:hover {
      background: rgba(255,255,255,0.2);
    }

    /* Official Statistics Section */
    .official-stats-section {
      background: #ffffff;
      border: 2px solid #1a472a;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    .stats-header {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      padding: 20px 30px;
      background: linear-gradient(180deg, #f8faf8 0%, #ffffff 100%);
      border-bottom: 3px double #1a472a;
    }

    .stats-header-logo img {
      width: 70px;
      height: 70px;
      object-fit: contain;
    }

    .stats-header-text {
      text-align: center;
      flex: 1;
    }

    .stats-republic {
      font-family: 'Times New Roman', Georgia, serif;
      font-size: 11px;
      color: #374151;
      margin: 0;
      letter-spacing: 1px;
      text-transform: uppercase;
    }

    .stats-university {
      font-family: 'Times New Roman', Georgia, serif;
      font-size: 17px;
      font-weight: 700;
      color: #1a472a;
      margin: 4px 0;
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    .stats-address {
      font-family: 'Times New Roman', Georgia, serif;
      font-size: 12px;
      color: #4b5563;
      margin: 2px 0;
      font-style: italic;
    }

    .stats-office {
      font-family: 'Times New Roman', Georgia, serif;
      font-size: 13px;
      font-weight: 600;
      color: #1a472a;
      margin: 6px 0 0 0;
      text-transform: uppercase;
      letter-spacing: 1.5px;
    }

    .stats-title-bar {
      background: #1a472a;
      color: #ffffff;
      padding: 14px 25px;
      text-align: center;
    }

    .stats-title {
      font-family: 'Poppins', sans-serif;
      font-size: 16px;
      font-weight: 600;
      margin: 0;
      letter-spacing: 3px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .stats-subtitle {
      font-family: 'Poppins', sans-serif;
      font-size: 11px;
      margin: 5px 0 0 0;
      opacity: 0.9;
    }

    /* Date Filter Bar */
    .report-filter-bar {
      background: #f8fafc;
      padding: 16px 25px;
      border-bottom: 1px solid #e5e7eb;
    }

    .filter-form {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      flex-wrap: wrap;
    }

    .filter-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .filter-group label {
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      font-weight: 500;
      color: #374151;
    }

    .filter-date {
      padding: 10px 14px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      background: #ffffff;
      min-width: 160px;
    }

    .filter-date:focus {
      outline: none;
      border-color: #1a472a;
      box-shadow: 0 0 0 3px rgba(26, 71, 42, 0.1);
    }

    .filter-btn {
      padding: 10px 20px;
      background: linear-gradient(135deg, #1a472a 0%, #2d6a3f 100%);
      color: #ffffff;
      border: none;
      border-radius: 8px;
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.2s;
    }

    .filter-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(26, 71, 42, 0.3);
    }

    .filter-btn-clear {
      padding: 10px 20px;
      background: #f3f4f6;
      color: #6b7280;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.2s;
    }

    .filter-btn-clear:hover {
      background: #e5e7eb;
    }

    /* Stats Grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 0;
    }

    .stat-card {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 20px;
      background: #ffffff;
      border-right: 1px solid #e5e7eb;
      transition: all 0.2s ease;
    }

    .stat-card:last-child {
      border-right: none;
    }

    .stat-card:hover {
      background: #f0fdf4;
    }

    .stat-icon {
      width: 56px;
      height: 56px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
      flex-shrink: 0;
    }

    .stat-icon-total {
      background: linear-gradient(135deg, #1a472a 0%, #2d6a3f 100%);
      color: #ffffff;
    }

    .stat-icon-pending {
      background: linear-gradient(135deg, #d97706 0%, #f59e0b 100%);
      color: #ffffff;
    }

    .stat-icon-progress {
      background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
      color: #ffffff;
    }

    .stat-icon-resolved {
      background: linear-gradient(135deg, #059669 0%, #10b981 100%);
      color: #ffffff;
    }

    .stat-content {
      display: flex;
      flex-direction: column;
    }

    .stat-label {
      font-family: 'Poppins', sans-serif;
      font-size: 11px;
      font-weight: 600;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .stat-value {
      font-family: 'Poppins', sans-serif;
      font-size: 28px;
      font-weight: 700;
      color: #1a472a;
      line-height: 1.2;
    }

    .stat-desc {
      font-family: 'Poppins', sans-serif;
      font-size: 10px;
      color: #9ca3af;
      margin-top: 2px;
    }

    /* Official Directory Section */
    .official-directory-section {
      background: #ffffff;
      border: 2px solid #1a472a;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    .directory-title-bar {
      background: #1a472a;
      color: #ffffff;
      padding: 14px 25px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .directory-title {
      font-family: 'Poppins', sans-serif;
      font-size: 14px;
      font-weight: 600;
      margin: 0;
      letter-spacing: 2px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .directory-subtitle {
      font-family: 'Poppins', sans-serif;
      font-size: 11px;
      margin: 0;
      opacity: 0.85;
    }

    /* Breakdown Section */
    .breakdown-container {
      padding: 25px;
    }

    .breakdown-item {
      margin-bottom: 20px;
    }

    .breakdown-item:last-child {
      margin-bottom: 0;
    }

    .breakdown-bar {
      height: 24px;
      background: #e5e7eb;
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 8px;
    }

    .breakdown-fill {
      height: 100%;
      background: linear-gradient(135deg, #1a472a 0%, #2d6a3f 100%);
      border-radius: 12px;
      transition: width 0.5s ease;
    }

    .breakdown-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .breakdown-name {
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      font-weight: 500;
      color: #374151;
    }

    .breakdown-count {
      font-family: 'Poppins', sans-serif;
      font-size: 12px;
      color: #6b7280;
    }

    .empty-breakdown {
      text-align: center;
      padding: 40px;
      color: #9ca3af;
    }

    .empty-breakdown i {
      font-size: 36px;
      margin-bottom: 12px;
      display: block;
    }

    /* Analytics Row */
    .analytics-row {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }

    .analytics-card {
      background: #ffffff;
      border: 2px solid #1a472a;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    .analytics-header {
      background: #1a472a;
      color: #ffffff;
      padding: 12px 20px;
    }

    .analytics-header h3 {
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      font-weight: 600;
      margin: 0;
      letter-spacing: 1px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .analytics-content {
      padding: 20px;
    }

    /* Analytics Table */
    .analytics-table {
      width: 100%;
      border-collapse: collapse;
    }

    .analytics-table th {
      background: #f8fafc;
      padding: 10px 12px;
      text-align: left;
      font-family: 'Poppins', sans-serif;
      font-size: 10px;
      font-weight: 600;
      color: #1a472a;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-bottom: 1px solid #e5e7eb;
    }

    .analytics-table td {
      padding: 12px;
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      color: #374151;
      border-bottom: 1px solid #f3f4f6;
    }

    .analytics-table tbody tr:hover {
      background: #f0fdf4;
    }

    .analytics-table a {
      color: #1a472a;
      text-decoration: none;
      font-weight: 500;
    }

    .analytics-table a:hover {
      text-decoration: underline;
    }

    .count-badge {
      display: inline-block;
      padding: 4px 12px;
      background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
      color: #dc2626;
      font-weight: 600;
      font-size: 12px;
      border-radius: 20px;
    }

    .student-id-sub, .time-sub {
      font-size: 11px;
      color: #9ca3af;
      margin-top: 2px;
    }

    .empty-cell {
      text-align: center;
      color: #9ca3af;
      font-style: italic;
    }

    /* Trend Chart */
    .trend-chart {
      display: flex;
      align-items: flex-end;
      justify-content: space-around;
      height: 180px;
      padding: 20px 0;
    }

    .trend-bar-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      flex: 1;
    }

    .trend-bar {
      width: 40px;
      background: linear-gradient(180deg, #1a472a 0%, #2d6a3f 100%);
      border-radius: 4px 4px 0 0;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      min-height: 20px;
      transition: height 0.5s ease;
    }

    .trend-value {
      font-family: 'Poppins', sans-serif;
      font-size: 11px;
      font-weight: 600;
      color: #ffffff;
      padding: 4px;
    }

    .trend-label {
      font-family: 'Poppins', sans-serif;
      font-size: 10px;
      color: #6b7280;
      margin-top: 8px;
    }

    .empty-trend {
      width: 100%;
      text-align: center;
      color: #9ca3af;
    }

    .empty-trend i {
      font-size: 32px;
      margin-bottom: 8px;
      display: block;
    }

    /* Directory Table */
    .directory-table-wrapper {
      overflow-x: auto;
    }

    .directory-table {
      width: 100%;
      border-collapse: collapse;
    }

    .directory-table th {
      background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
      padding: 14px 16px;
      text-align: left;
      font-family: 'Poppins', sans-serif;
      font-size: 11px;
      font-weight: 600;
      color: #1a472a;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-bottom: 2px solid #1a472a;
    }

    .directory-table td {
      padding: 14px 16px;
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      color: #374151;
      border-bottom: 1px solid #e5e7eb;
      vertical-align: middle;
    }

    .directory-table tbody tr:hover {
      background: #f0fdf4;
    }

    .col-seq { width: 50px; text-align: center; color: #9ca3af; }

    .student-link {
      color: #1a472a;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.2s;
    }

    .student-link:hover {
      color: #2d6a3f;
      text-decoration: underline;
    }

    .type-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
      background: #f3f4f6;
      color: #374151;
    }

    .type-minor { background: #fef3c7; color: #d97706; }
    .type-major { background: #fee2e2; color: #dc2626; }
    .type-severe { background: #fce7f3; color: #db2777; }

    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 10px;
      font-weight: 600;
    }

    .status-pending {
      background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      color: #d97706;
    }

    .status-progress {
      background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
      color: #2563eb;
    }

    .status-resolved {
      background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
      color: #059669;
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px !important;
      color: #9ca3af;
    }

    .empty-state i {
      font-size: 48px;
      margin-bottom: 16px;
      display: block;
    }

    .empty-state p {
      font-size: 16px;
      font-weight: 500;
      color: #6b7280;
      margin: 0 0 8px 0;
    }

    .empty-state span {
      font-size: 13px;
    }

    /* Footer */
    .directory-footer {
      background: #f9fafb;
      padding: 12px 20px;
      border-top: 1px solid #e5e7eb;
      text-align: center;
    }

    .directory-footer p {
      font-family: 'Poppins', sans-serif;
      font-size: 11px;
      color: #6b7280;
      margin: 0;
    }

    .directory-footer i {
      color: #1a472a;
      margin-right: 4px;
    }

    .print-only {
      display: none;
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .stat-card {
        border-bottom: 1px solid #e5e7eb;
      }

      .analytics-row {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .stats-header {
        flex-direction: column;
        gap: 10px;
        padding: 15px;
      }

      .stats-header-logo:last-child {
        display: none;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }

      .stat-card {
        border-right: none;
      }

      .nav-center {
        display: none;
      }

      .filter-form {
        flex-direction: column;
      }

      .filter-group {
        width: 100%;
        justify-content: center;
      }
    }

    @media print {
      .no-print { display: none !important; }
      .official-top-nav { display: none; }
      .print-only { display: block; }
      
      body {
        background: #ffffff;
      }

      .official-stats-section,
      .official-directory-section,
      .analytics-card {
        box-shadow: none;
        page-break-inside: avoid;
      }

      .analytics-row {
        grid-template-columns: 1fr;
      }
    }

    /* Export Dropdown */
    .export-dropdown {
      position: relative;
    }

    .export-menu {
      position: absolute;
      top: 100%;
      right: 0;
      margin-top: 8px;
      background: #ffffff;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      min-width: 180px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.2s;
      z-index: 1000;
    }

    .export-menu.show {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .export-option {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 16px;
      color: #374151;
      text-decoration: none;
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      border: none;
      background: none;
      width: 100%;
      cursor: pointer;
      transition: background 0.2s;
    }

    .export-option:hover {
      background: #f3f4f6;
    }

    .export-option i {
      width: 18px;
      color: #1a472a;
    }

    /* Metrics Row */
    .metrics-row {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }

    .metric-card {
      background: #ffffff;
      border: 2px solid #1a472a;
      border-radius: 0;
      padding: 20px;
      display: flex;
      align-items: center;
      gap: 16px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    .metric-icon {
      width: 56px;
      height: 56px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      color: #ffffff;
      flex-shrink: 0;
    }

    .metric-content {
      display: flex;
      flex-direction: column;
      flex: 1;
    }

    .metric-label {
      font-family: 'Poppins', sans-serif;
      font-size: 11px;
      font-weight: 600;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .metric-value {
      font-family: 'Poppins', sans-serif;
      font-size: 28px;
      font-weight: 700;
      color: #1a472a;
      line-height: 1.2;
    }

    .metric-desc {
      font-family: 'Poppins', sans-serif;
      font-size: 10px;
      color: #9ca3af;
    }

    .metric-visual {
      flex-shrink: 0;
    }

    .progress-ring-bg {
      stroke-dasharray: 151;
    }

    .progress-ring-circle {
      stroke-dasharray: 0 151;
      transition: stroke-dasharray 0.5s;
    }

    /* Apology Stats Grid */
    .apology-stats-grid {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 0;
      padding: 0;
    }

    .apology-stat-card {
      padding: 25px 20px;
      text-align: center;
      border-right: 1px solid #e5e7eb;
      transition: background 0.2s;
    }

    .apology-stat-card:last-child {
      border-right: none;
    }

    .apology-stat-card:hover {
      background: #f0fdf4;
    }

    .apology-stat-icon {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      margin: 0 auto 12px;
    }

    .apology-stat-icon.pending {
      background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      color: #d97706;
    }

    .apology-stat-icon.approved {
      background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
      color: #059669;
    }

    .apology-stat-icon.rejected {
      background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
      color: #dc2626;
    }

    .apology-stat-icon.revision {
      background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      color: #f59e0b;
    }

    .apology-stat-icon.formator {
      background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
      color: #2563eb;
    }

    .apology-stat-icon.signed {
      background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
      color: #4f46e5;
    }

    .apology-stat-value {
      font-family: 'Poppins', sans-serif;
      font-size: 28px;
      font-weight: 700;
      color: #1a472a;
      display: block;
    }

    .apology-stat-label {
      font-family: 'Poppins', sans-serif;
      font-size: 11px;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 4px;
    }

    /* Severity Container */
    .severity-container {
      padding: 25px;
    }

    .severity-item {
      margin-bottom: 24px;
    }

    .severity-item:last-child {
      margin-bottom: 0;
    }

    .severity-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .severity-label {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 14px;
      border-radius: 6px;
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      font-weight: 600;
    }

    .severity-label.severity-minor {
      background: #fef3c7;
      color: #d97706;
    }

    .severity-label.severity-major {
      background: #fee2e2;
      color: #dc2626;
    }

    .severity-label.severity-grave {
      background: #ede9fe;
      color: #7c3aed;
    }

    .severity-count {
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      color: #6b7280;
    }

    .severity-bar {
      height: 16px;
      background: #e5e7eb;
      border-radius: 8px;
      overflow: hidden;
    }

    .severity-fill {
      height: 100%;
      border-radius: 8px;
      transition: width 0.5s ease;
    }

    /* Program Container */
    .program-container {
      padding: 25px;
      max-height: 400px;
      overflow-y: auto;
    }

    .program-item {
      margin-bottom: 16px;
    }

    .program-item:last-child {
      margin-bottom: 0;
    }

    .program-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    .program-name {
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      font-weight: 500;
      color: #374151;
    }

    .program-stats {
      font-family: 'Poppins', sans-serif;
      font-size: 12px;
      color: #6b7280;
    }

    .program-bar {
      height: 12px;
      background: #e5e7eb;
      border-radius: 6px;
      overflow: hidden;
    }

    .program-fill {
      height: 100%;
      border-radius: 6px;
      transition: width 0.5s ease;
    }

    /* Year Level Container */
    .year-level-container {
      display: flex;
      justify-content: center;
      align-items: flex-end;
      gap: 30px;
      padding: 30px 25px;
      min-height: 250px;
    }

    .year-level-card {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .year-level-num {
      font-family: 'Poppins', sans-serif;
      font-size: 32px;
      font-weight: 700;
      color: #1a472a;
      line-height: 1;
    }

    .year-level-label {
      font-family: 'Poppins', sans-serif;
      font-size: 11px;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 4px;
    }

    .year-level-count {
      font-family: 'Poppins', sans-serif;
      font-size: 18px;
      font-weight: 600;
      color: #ffffff;
      background: #1a472a;
      padding: 4px 12px;
      border-radius: 20px;
      margin-top: 12px;
    }

    .year-level-bar-wrap {
      width: 50px;
      height: 120px;
      background: #e5e7eb;
      border-radius: 4px 4px 0 0;
      margin-top: 12px;
      position: relative;
      overflow: hidden;
    }

    .year-level-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      background: linear-gradient(180deg, #1a472a 0%, #2d6a3f 100%);
      border-radius: 4px 4px 0 0;
      transition: height 0.5s ease;
    }

    /* Modal Styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 20000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
    }

    .modal-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .modal-container {
      background: #ffffff;
      border-radius: 12px;
      width: 90%;
      max-width: 550px;
      max-height: 90vh;
      overflow: hidden;
      transform: translateY(20px);
      transition: transform 0.3s;
    }

    .modal-overlay.show .modal-container {
      transform: translateY(0);
    }

    .modal-header {
      background: linear-gradient(135deg, #1a472a 0%, #2d5a3f 100%);
      color: #ffffff;
      padding: 18px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .modal-header h3 {
      font-family: 'Poppins', sans-serif;
      font-size: 16px;
      font-weight: 600;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .modal-close {
      background: none;
      border: none;
      color: #ffffff;
      font-size: 24px;
      cursor: pointer;
      opacity: 0.8;
      transition: opacity 0.2s;
    }

    .modal-close:hover {
      opacity: 1;
    }

    .modal-body {
      padding: 24px;
      max-height: 60vh;
      overflow-y: auto;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      font-weight: 600;
      color: #374151;
      margin-bottom: 8px;
    }

    .form-static {
      font-family: 'Poppins', sans-serif;
      font-size: 14px;
      color: #1a472a;
      margin: 0;
      padding: 10px 14px;
      background: #f0fdf4;
      border-radius: 8px;
      border: 1px solid #d1fae5;
    }

    .form-textarea {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-family: 'Poppins', sans-serif;
      font-size: 14px;
      resize: vertical;
      transition: border-color 0.2s;
    }

    .form-textarea:focus {
      outline: none;
      border-color: #1a472a;
      box-shadow: 0 0 0 3px rgba(26, 71, 42, 0.1);
    }

    .report-summary {
      background: #f9fafb;
      border-radius: 8px;
      padding: 16px;
      border: 1px solid #e5e7eb;
    }

    .report-summary h4 {
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      font-weight: 600;
      color: #374151;
      margin: 0 0 12px 0;
    }

    .summary-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }

    .summary-item {
      text-align: center;
      padding: 10px;
      background: #ffffff;
      border-radius: 6px;
    }

    .summary-label {
      display: block;
      font-family: 'Poppins', sans-serif;
      font-size: 10px;
      color: #6b7280;
      text-transform: uppercase;
    }

    .summary-value {
      display: block;
      font-family: 'Poppins', sans-serif;
      font-size: 20px;
      font-weight: 700;
      color: #1a472a;
    }

    .modal-footer {
      padding: 16px 24px;
      background: #f9fafb;
      border-top: 1px solid #e5e7eb;
      display: flex;
      justify-content: flex-end;
      gap: 12px;
    }

    .btn-cancel {
      padding: 10px 20px;
      background: #ffffff;
      color: #6b7280;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-cancel:hover {
      background: #f3f4f6;
    }

    .btn-send {
      padding: 10px 20px;
      background: linear-gradient(135deg, #1a472a 0%, #2d6a3f 100%);
      color: #ffffff;
      border: none;
      border-radius: 8px;
      font-family: 'Poppins', sans-serif;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.2s;
    }

    .btn-send:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(26, 71, 42, 0.3);
    }

    /* Responsive for new sections */
    @media (max-width: 1200px) {
      .metrics-row {
        grid-template-columns: repeat(2, 1fr);
      }

      .apology-stats-grid {
        grid-template-columns: repeat(3, 1fr);
      }

      .apology-stat-card {
        border-bottom: 1px solid #e5e7eb;
      }

      .apology-stat-card:nth-child(3) {
        border-right: none;
      }
    }

    @media (max-width: 768px) {
      .metrics-row {
        grid-template-columns: 1fr;
      }

      .apology-stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .apology-stat-card:nth-child(odd) {
        border-right: 1px solid #e5e7eb;
      }

      .apology-stat-card:nth-child(even) {
        border-right: none;
      }

      .year-level-container {
        flex-wrap: wrap;
        gap: 20px;
      }

      .summary-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media print {
      .metrics-row,
      .apology-stats-grid {
        page-break-inside: avoid;
      }

      .modal-overlay {
        display: none !important;
      }
    }

    /* ========================================
       COMPREHENSIVE PRINT STYLES - OPTIMIZED
       For A4 Portrait (210mm x 297mm)
       ======================================== */
    
    /* Page setup - A4 Portrait with balanced margins */
    @page {
      size: 210mm 297mm portrait;
      margin: 8mm 10mm 12mm 10mm;
    }

    @page :first {
      margin-top: 8mm;
    }

    @media print {
      /* ===== RESET & BASE ===== */
      *, *::before, *::after {
        box-shadow: none !important;
        text-shadow: none !important;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        color-adjust: exact !important;
        transition: none !important;
        animation: none !important;
      }

      html {
        width: 210mm !important;
        height: auto !important;
        margin: 0 !important;
        padding: 0 !important;
        background: #ffffff !important;
        font-size: 9pt !important;
        overflow: visible !important;
      }

      body {
        width: 190mm !important;
        max-width: 190mm !important;
        height: auto !important;
        margin: 0 auto !important;
        padding: 0 !important;
        background: #ffffff !important;
        font-size: 9pt !important;
        line-height: 1.35 !important;
        font-family: 'Segoe UI', 'Arial', sans-serif !important;
        overflow: visible !important;
      }

      /* ===== HIDE NON-PRINT ELEMENTS ===== */
      .no-print,
      .official-top-nav,
      .background-overlay,
      .background-image,
      .nav-actions,
      .nav-container,
      .report-filter-bar,
      .modal-overlay,
      .export-dropdown,
      .export-menu,
      .quick-action-btn,
      .filter-form,
      .filter-group,
      .filter-btn,
      .filter-btn-clear,
      button:not(.print-only),
      .metric-visual,
      .progress-ring,
      svg.progress-ring {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        width: 0 !important;
        overflow: hidden !important;
      }

      /* ===== SHOW PRINT-ONLY ELEMENTS ===== */
      .print-only {
        display: block !important;
        visibility: visible !important;
      }

      /* ===== CONTAINER - FULL WIDTH ===== */
      .container,
      main.container {
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        position: relative !important;
      }

      main.container {
        margin-top: 0 !important;
      }

      /* ===== SECTIONS - PAGE BREAK CONTROL ===== */
      .official-stats-section {
        border: 1.5pt solid #1a472a !important;
        box-shadow: none !important;
        margin-bottom: 4mm !important;
        page-break-inside: avoid !important;
        break-inside: avoid !important;
        width: 100% !important;
        overflow: hidden !important;
      }

      .official-directory-section,
      .metrics-row,
      section {
        border: 1pt solid #1a472a !important;
        box-shadow: none !important;
        margin-bottom: 4mm !important;
        margin-top: 0 !important;
        page-break-inside: avoid !important;
        break-inside: avoid !important;
        width: 100% !important;
        overflow: hidden !important;
      }

      /* Allow page breaks for long content sections */
      .official-directory-section:has(.directory-table) {
        page-break-inside: auto !important;
      }

      .directory-table-wrapper {
        page-break-inside: auto !important;
        overflow: visible !important;
      }

      .directory-table {
        page-break-inside: auto !important;
      }

      .directory-table thead {
        display: table-header-group !important;
      }

      .directory-table tbody {
        page-break-inside: auto !important;
      }

      .directory-table tr {
        page-break-inside: avoid !important;
        break-inside: avoid !important;
      }

      /* ===== DOCUMENT HEADER - COMPACT ===== */
      .stats-header {
        padding: 4mm 4mm !important;
        border-bottom: 1.5pt solid #1a472a !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 8px !important;
        background: linear-gradient(180deg, #fafafa 0%, #ffffff 100%) !important;
      }

      .stats-header-logo {
        flex-shrink: 0 !important;
      }

      .stats-header-logo img {
        width: 35px !important;
        height: 35px !important;
        object-fit: contain !important;
      }

      .stats-header-logo:last-child {
        display: none !important;
      }

      .stats-header-text {
        flex: 1 !important;
        text-align: center !important;
      }

      .stats-university {
        font-size: 10pt !important;
        font-weight: 700 !important;
        margin: 1px 0 !important;
        letter-spacing: 0.5px !important;
        color: #1a472a !important;
      }

      .stats-republic {
        font-size: 7pt !important;
        margin: 0 !important;
        color: #374151 !important;
      }

      .stats-address {
        font-size: 7pt !important;
        margin: 0 !important;
        font-style: italic !important;
        color: #4b5563 !important;
      }

      .stats-office {
        font-size: 8pt !important;
        font-weight: 600 !important;
        margin: 2px 0 0 0 !important;
        color: #1a472a !important;
      }

      /* ===== TITLE BARS - DARK GREEN ===== */
      .stats-title-bar,
      .directory-title-bar {
        background: #1a472a !important;
        color: #ffffff !important;
        padding: 3mm 4mm !important;
        text-align: center !important;
      }

      .stats-title,
      .directory-title {
        font-size: 9pt !important;
        font-weight: 600 !important;
        letter-spacing: 1.5px !important;
        margin: 0 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 6px !important;
      }

      .stats-title i,
      .directory-title i {
        font-size: 10pt !important;
      }

      .stats-subtitle,
      .directory-subtitle {
        font-size: 7pt !important;
        margin: 2px 0 0 0 !important;
        opacity: 0.9 !important;
      }

      /* ===== MAIN STATS GRID - 4 COLUMNS ===== */
      .stats-grid {
        display: grid !important;
        grid-template-columns: repeat(4, 1fr) !important;
        gap: 0 !important;
        width: 100% !important;
        border-top: none !important;
      }

      .stat-card {
        padding: 3mm 2.5mm !important;
        border: none !important;
        border-right: 0.5pt solid #d1d5db !important;
        border-bottom: 0.5pt solid #d1d5db !important;
        display: flex !important;
        align-items: center !important;
        gap: 6px !important;
        background: #ffffff !important;
      }

      .stat-card:nth-child(4n) {
        border-right: none !important;
      }

      .stat-card:nth-child(n+5) {
        border-bottom: none !important;
      }

      .stat-icon {
        width: 22px !important;
        height: 22px !important;
        min-width: 22px !important;
        font-size: 9pt !important;
        border-radius: 4px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
      }

      .stat-icon-total {
        background: #1a472a !important;
        color: #ffffff !important;
      }

      .stat-icon-pending {
        background: #d97706 !important;
        color: #ffffff !important;
      }

      .stat-icon-progress {
        background: #2563eb !important;
        color: #ffffff !important;
      }

      .stat-icon-resolved {
        background: #059669 !important;
        color: #ffffff !important;
      }

      .stat-content {
        flex: 1 !important;
        min-width: 0 !important;
      }

      .stat-value {
        font-size: 13pt !important;
        font-weight: 700 !important;
        line-height: 1 !important;
        color: #1a472a !important;
        display: block !important;
      }

      .stat-label {
        font-size: 6pt !important;
        text-transform: uppercase !important;
        letter-spacing: 0.3px !important;
        color: #6b7280 !important;
        display: block !important;
        margin-bottom: 1px !important;
      }

      .stat-desc {
        display: none !important;
      }

      /* ===== METRICS ROW - 3 COLUMNS ===== */
      .metrics-row {
        display: grid !important;
        grid-template-columns: repeat(3, 1fr) !important;
        gap: 0 !important;
        border: 1pt solid #1a472a !important;
        margin-top: 4mm !important;
        background: #ffffff !important;
      }

      .metric-card {
        padding: 3mm !important;
        border: none !important;
        border-right: 0.5pt solid #d1d5db !important;
        display: flex !important;
        align-items: center !important;
        gap: 6px !important;
        background: transparent !important;
      }

      .metric-card:last-child {
        border-right: none !important;
      }

      .metric-icon {
        width: 22px !important;
        height: 22px !important;
        min-width: 22px !important;
        font-size: 9pt !important;
        border-radius: 4px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
      }

      .metric-content {
        flex: 1 !important;
      }

      .metric-value {
        font-size: 11pt !important;
        font-weight: 700 !important;
        color: #1a472a !important;
        display: block !important;
        line-height: 1.1 !important;
      }

      .metric-label {
        font-size: 6pt !important;
        text-transform: uppercase !important;
        color: #6b7280 !important;
        display: block !important;
      }

      .metric-desc {
        font-size: 5pt !important;
        color: #9ca3af !important;
      }

      .metric-visual,
      .progress-ring,
      .resolution-metric .metric-visual {
        display: none !important;
        width: 0 !important;
        height: 0 !important;
      }

      /* ===== APOLOGY STATS - 3x2 GRID ===== */
      .apology-stats-grid {
        display: grid !important;
        grid-template-columns: repeat(3, 1fr) !important;
        gap: 0 !important;
        padding: 0 !important;
      }

      .apology-stat-card {
        padding: 2.5mm !important;
        border: none !important;
        border-right: 0.5pt solid #d1d5db !important;
        border-bottom: 0.5pt solid #d1d5db !important;
        text-align: center !important;
        background: #ffffff !important;
      }

      .apology-stat-card:nth-child(3n) {
        border-right: none !important;
      }

      .apology-stat-card:nth-child(n+4) {
        border-bottom: none !important;
      }

      .apology-stat-icon {
        width: 18px !important;
        height: 18px !important;
        font-size: 8pt !important;
        margin: 0 auto 2px !important;
        border-radius: 4px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
      }

      .apology-stat-icon.pending { background: #fef3c7 !important; color: #d97706 !important; }
      .apology-stat-icon.approved { background: #d1fae5 !important; color: #059669 !important; }
      .apology-stat-icon.rejected { background: #fee2e2 !important; color: #dc2626 !important; }
      .apology-stat-icon.revision { background: #dbeafe !important; color: #2563eb !important; }
      .apology-stat-icon.formator { background: #f3e8ff !important; color: #7c3aed !important; }
      .apology-stat-icon.signed { background: #d1fae5 !important; color: #059669 !important; }

      .apology-stat-value {
        font-size: 11pt !important;
        font-weight: 700 !important;
        color: #1a472a !important;
        line-height: 1.1 !important;
      }

      .apology-stat-label {
        font-size: 5pt !important;
        color: #6b7280 !important;
        text-transform: uppercase !important;
      }

      /* ===== SEVERITY DISTRIBUTION ===== */
      .severity-container {
        padding: 3mm !important;
        max-height: none !important;
        overflow: visible !important;
      }

      .severity-item {
        margin-bottom: 2.5mm !important;
      }

      .severity-item:last-child {
        margin-bottom: 0 !important;
      }

      .severity-header {
        display: flex !important;
        justify-content: space-between !important;
        align-items: center !important;
        margin-bottom: 1.5mm !important;
      }

      .severity-label {
        font-size: 7pt !important;
        font-weight: 600 !important;
        padding: 1px 6px !important;
        border-radius: 3px !important;
        display: inline-flex !important;
        align-items: center !important;
        gap: 3px !important;
      }

      .severity-label i {
        font-size: 6pt !important;
      }

      .severity-minor { background: #fef3c7 !important; color: #d97706 !important; }
      .severity-major { background: #fee2e2 !important; color: #dc2626 !important; }
      .severity-severe { background: #fce7f3 !important; color: #db2777 !important; }

      .severity-count {
        font-size: 6pt !important;
        color: #6b7280 !important;
      }

      .severity-bar {
        height: 6px !important;
        background: #e5e7eb !important;
        border-radius: 3px !important;
        overflow: hidden !important;
      }

      .severity-fill {
        height: 100% !important;
        border-radius: 3px !important;
      }

      /* ===== PROGRAM BREAKDOWN ===== */
      .program-container {
        padding: 3mm !important;
        max-height: none !important;
        overflow: visible !important;
      }

      .program-item {
        margin-bottom: 2.5mm !important;
      }

      .program-item:last-child {
        margin-bottom: 0 !important;
      }

      .program-info {
        display: flex !important;
        justify-content: space-between !important;
        font-size: 7pt !important;
        margin-bottom: 1.5mm !important;
      }

      .program-name {
        font-weight: 500 !important;
        color: #374151 !important;
      }

      .program-stats {
        color: #6b7280 !important;
      }

      .program-bar {
        height: 6px !important;
        background: #e5e7eb !important;
        border-radius: 3px !important;
        overflow: hidden !important;
      }

      .program-fill {
        height: 100% !important;
        border-radius: 3px !important;
      }

      /* ===== YEAR LEVEL ANALYSIS ===== */
      .year-level-container {
        padding: 3mm !important;
        min-height: auto !important;
        display: flex !important;
        justify-content: center !important;
        align-items: flex-end !important;
        gap: 6px !important;
      }

      .year-level-card {
        width: 40px !important;
        padding: 2mm !important;
        text-align: center !important;
        background: #f8fafc !important;
        border: 0.5pt solid #e5e7eb !important;
        border-radius: 4px !important;
      }

      .year-level-num {
        font-size: 12pt !important;
        font-weight: 700 !important;
        color: #1a472a !important;
        line-height: 1 !important;
      }

      .year-level-label {
        font-size: 5pt !important;
        color: #6b7280 !important;
        text-transform: uppercase !important;
      }

      .year-level-count {
        font-size: 9pt !important;
        font-weight: 600 !important;
        color: #374151 !important;
        margin-top: 2px !important;
      }

      .year-level-bar-wrap {
        height: 30px !important;
        margin-top: 2mm !important;
      }

      .year-level-bar {
        background: linear-gradient(180deg, #1a472a 0%, #2d6a3f 100%) !important;
        border-radius: 2px !important;
      }

      /* ===== VIOLATION TYPE BREAKDOWN ===== */
      .breakdown-container {
        padding: 3mm !important;
      }

      .breakdown-item {
        margin-bottom: 2.5mm !important;
      }

      .breakdown-item:last-child {
        margin-bottom: 0 !important;
      }

      .breakdown-info {
        display: flex !important;
        justify-content: space-between !important;
        font-size: 7pt !important;
        margin-bottom: 1.5mm !important;
      }

      .breakdown-name {
        font-weight: 500 !important;
        color: #374151 !important;
      }

      .breakdown-count {
        color: #6b7280 !important;
      }

      .breakdown-bar {
        height: 8px !important;
        background: #e5e7eb !important;
        border-radius: 4px !important;
        overflow: hidden !important;
      }

      .breakdown-fill {
        height: 100% !important;
        border-radius: 4px !important;
      }

      /* ===== ANALYTICS ROW - STACKED ===== */
      .analytics-row {
        display: flex !important;
        flex-direction: column !important;
        gap: 4mm !important;
        margin-top: 4mm !important;
      }

      .analytics-card {
        border: 1pt solid #1a472a !important;
        box-shadow: none !important;
        page-break-inside: avoid !important;
        break-inside: avoid !important;
        overflow: hidden !important;
      }

      .analytics-header {
        background: #1a472a !important;
        color: #ffffff !important;
        padding: 2.5mm 3mm !important;
      }

      .analytics-header h3 {
        font-size: 8pt !important;
        font-weight: 600 !important;
        margin: 0 !important;
        display: flex !important;
        align-items: center !important;
        gap: 5px !important;
      }

      .analytics-header h3 i {
        font-size: 8pt !important;
      }

      .analytics-content {
        padding: 3mm !important;
      }

      /* ===== ANALYTICS TABLES ===== */
      .analytics-table {
        width: 100% !important;
        font-size: 7pt !important;
        border-collapse: collapse !important;
      }

      .analytics-table th {
        background: #f8fafc !important;
        padding: 2mm !important;
        font-size: 6pt !important;
        font-weight: 600 !important;
        text-transform: uppercase !important;
        text-align: left !important;
        border-bottom: 0.5pt solid #1a472a !important;
        color: #374151 !important;
      }

      .analytics-table td {
        padding: 1.5mm 2mm !important;
        font-size: 7pt !important;
        border-bottom: 0.5pt solid #e5e7eb !important;
        vertical-align: middle !important;
      }

      .analytics-table tbody tr:last-child td {
        border-bottom: none !important;
      }

      .analytics-table a {
        color: #1a472a !important;
        text-decoration: none !important;
        font-weight: 500 !important;
      }

      .student-id-sub {
        font-size: 5pt !important;
        color: #9ca3af !important;
        display: block !important;
      }

      .count-badge {
        background: #1a472a !important;
        color: #ffffff !important;
        font-size: 6pt !important;
        padding: 1px 5px !important;
        border-radius: 10px !important;
        font-weight: 600 !important;
      }

      /* ===== TREND CHART ===== */
      .trend-chart {
        height: 60px !important;
        padding: 2mm 0 !important;
        display: flex !important;
        align-items: flex-end !important;
        justify-content: center !important;
        gap: 3px !important;
      }

      .trend-bar-container {
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
        width: 16px !important;
      }

      .trend-bar {
        width: 14px !important;
        min-height: 3px !important;
        background: linear-gradient(180deg, #1a472a 0%, #2d6a3f 100%) !important;
        border-radius: 2px 2px 0 0 !important;
        position: relative !important;
      }

      .trend-value {
        font-size: 5pt !important;
        font-weight: 600 !important;
        color: #ffffff !important;
        position: absolute !important;
        top: 2px !important;
        left: 50% !important;
        transform: translateX(-50%) !important;
      }

      .trend-label {
        font-size: 4pt !important;
        color: #6b7280 !important;
        margin-top: 1mm !important;
        text-transform: uppercase !important;
      }

      /* ===== DIRECTORY TABLE - RECENT VIOLATIONS ===== */
      .directory-table {
        width: 100% !important;
        font-size: 7pt !important;
        border-collapse: collapse !important;
      }

      .directory-table th {
        background: #f1f5f9 !important;
        padding: 2mm 2.5mm !important;
        font-size: 6pt !important;
        font-weight: 600 !important;
        text-transform: uppercase !important;
        text-align: left !important;
        border-bottom: 1pt solid #1a472a !important;
        color: #374151 !important;
        white-space: nowrap !important;
      }

      .directory-table td {
        padding: 1.5mm 2.5mm !important;
        font-size: 7pt !important;
        border-bottom: 0.5pt solid #e5e7eb !important;
        vertical-align: middle !important;
      }

      .directory-table tbody tr:last-child td {
        border-bottom: none !important;
      }

      .directory-table .col-seq {
        width: 20px !important;
        text-align: center !important;
        color: #9ca3af !important;
      }

      .directory-table .col-name a,
      .student-link {
        color: #1a472a !important;
        text-decoration: none !important;
        font-weight: 500 !important;
      }

      .time-sub {
        font-size: 5pt !important;
        color: #9ca3af !important;
        display: block !important;
      }

      /* ===== BADGES ===== */
      .status-badge {
        font-size: 5pt !important;
        padding: 1px 4px !important;
        border-radius: 3px !important;
        font-weight: 600 !important;
        display: inline-flex !important;
        align-items: center !important;
        gap: 2px !important;
        white-space: nowrap !important;
      }

      .status-badge i {
        font-size: 5pt !important;
      }

      .status-pending {
        background: #fef3c7 !important;
        color: #d97706 !important;
      }

      .status-progress {
        background: #dbeafe !important;
        color: #2563eb !important;
      }

      .status-resolved {
        background: #d1fae5 !important;
        color: #059669 !important;
      }

      .type-badge {
        font-size: 5pt !important;
        padding: 1px 4px !important;
        border-radius: 3px !important;
        font-weight: 500 !important;
        background: #f3f4f6 !important;
        color: #374151 !important;
      }

      .type-minor {
        background: #fef3c7 !important;
        color: #d97706 !important;
      }

      .type-major {
        background: #fee2e2 !important;
        color: #dc2626 !important;
      }

      /* ===== FOOTER ===== */
      .directory-footer {
        padding: 2.5mm 3mm !important;
        background: #f9fafb !important;
        border-top: 0.5pt solid #d1d5db !important;
        text-align: center !important;
      }

      .directory-footer p {
        font-size: 6pt !important;
        margin: 1px 0 !important;
        color: #6b7280 !important;
      }

      .directory-footer i {
        color: #1a472a !important;
      }

      /* ===== PAGE BREAK CONTROLS ===== */
      .page-break-before {
        page-break-before: always !important;
        break-before: page !important;
      }

      .page-break-after {
        page-break-after: always !important;
        break-after: page !important;
      }

      /* Prevent orphaned headers */
      h1, h2, h3, h4, h5, h6,
      .stats-title-bar,
      .directory-title-bar,
      .analytics-header {
        page-break-after: avoid !important;
        break-after: avoid !important;
      }

      /* Widows and orphans */
      p {
        orphans: 2 !important;
        widows: 2 !important;
      }

      /* ===== EMPTY STATES ===== */
      .empty-state,
      .empty-breakdown,
      .empty-trend,
      .empty-cell {
        padding: 4mm !important;
        font-size: 7pt !important;
        text-align: center !important;
        color: #9ca3af !important;
      }

      .empty-state i,
      .empty-breakdown i,
      .empty-trend i {
        font-size: 14pt !important;
        display: block !important;
        margin-bottom: 2mm !important;
      }

      /* ===== LINKS ===== */
      a {
        color: #1a472a !important;
        text-decoration: none !important;
      }

      a[href]:after {
        content: none !important;
      }

      /* ===== IMAGES ===== */
      img {
        max-width: 100% !important;
        page-break-inside: avoid !important;
      }
    }
  </style>
</body>
</html>
